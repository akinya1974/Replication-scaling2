# «Репликация и масштабирование. Часть 2» Акиньшин С.Г.

## Задание-1

### 1. `Опишите основные преимущества использования масштабирования методами`

1. Активный master-сервер и пассивный репликационный slave-сервер:

- Преимущество этого метода состоит в том, что активный master-сервер обрабатывает все запросы и операции записи данных, тогда как пассивный slave-сервер выполняет только операции чтения данных и реплицирует данные с master-сервера.
- Это обеспечивает высокую доступность данных, так как при сбое активного master-сервера, slave-сервер может быть превращен в новый активный сервер без потери данных.
- Этот подход также позволяет распределять нагрузку между серверами, так как slave-серверы могут обслуживать запросы на чтение и разгружать активный сервер.

2. Master-сервер и несколько slave-серверов:

- Этот метод также обеспечивает высокую доступность данных и распределение нагрузки между серверами.
- Master-сервер отвечает за обработку операций записи, а slave-серверы реплицируют данные с master-сервера и обслуживают операции чтения.
- В отличие от предыдущего метода, здесь может быть несколько slave-серверов, что позволяет более эффективно масштабировать систему с увеличением нагрузки.

3. Активный сервер со специальным механизмом репликации (DRBD):

- DRBD (distributed replicated block device) - это механизм репликации блочных устройств, который обеспечивает синхронную репликацию данных между серверами в реальном времени.
- При использовании DRBD, серверы образуют кластер и синхронно реплицируют данные друг с другом. При этом любой сервер может выступать в роли активного сервера.
- Этот подход обеспечивает высокую отказоустойчивость, так как в случае сбоя активного сервера, один из slave-серверов может стать новым активным сервером без потери данных.
- DRBD также позволяет масштабировать систему путем добавления дополнительных серверов в кластер.

4. SAN-кластер:

- SAN (Storage Area Network) - это сеть хранения данных, которая позволяет подключать несколько серверов к общему хранилищу данных.
- SAN-кластер предоставляет высокую производительность и доступность данных. Все серверы в кластере имеют общий доступ к данным, что позволяет равномерно распределить н

агрузку и обеспечить балансировку нагрузки.
- SAN-кластер также обладает отказоустойчивостью, так как при сбое одного из серверов, остальные серверы могут продолжать обслуживание запросов.
- Этот метод масштабирования также позволяет управлять хранением данных централизованно и обеспечивает возможность резервного копирования и восстановления данных.

## Задание-2

### 2. `Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц (пользователи), (книги), (магазины (столбцы произвольно)).`

При проектировании системы горизонтального и вертикального шаринга базы данных, мы можем использовать следующий план:

1. Анализ и проектирование схемы базы данных:
   - Создать таблицу "пользователи" с необходимыми столбцами для хранения информации о пользователях.
   - Создать таблицу "книги" с необходимыми столбцами для хранения информации о книгах.
   - Создать таблицу "магазины" с необходимыми столбцами для хранения информации о магазинах.
   - Определить связи между таблицами, например, связь между "книги" и "магазины" для отслеживания наличия книг в магазинах.

2. Вертикальный шаринг:
   - Идентифицировать столбцы с высокой частотой использования и отделить их от основных таблиц.
   - Создать отдельные таблицы для выделенных столбцов, чтобы уменьшить размер основных таблиц.
   - Связать вертикально разделенные таблицы с основными таблицами по уникальным идентификаторам.

3. Горизонтальный шаринг:
   - Идентифицировать критерии для разделения данных между серверами. Например, можно разделить данные по регионам, по первым буквам фамилии пользователя или по другим параметрам.
   - Создать несколько серверов баз данных и распределить данные между ними в соответствии с выбранными критериями.
   - Настроить механизмы репликации данных между серверами, чтобы обеспечить согласованность данных.

4. Блок-схема системы:
   Вертикальный шаринг:
   ```
   +----------+
   | Пользователи |     +-------------------+
   +----------+ |     | Выделенные столбцы |
                +---->+-------------------+
   +-------+    |     |  Книги            |
   | Магазины +---->+-------------------+
   +-------+    |
   ```

   Горизонтальный шаринг:
   ```
   +-----------------+     +------------------+
   | Сервер БД 1     |     | Сервер БД 2      |
   +-----------------+     +------------------+
   | Пользователи 1  |     | Пользователи 2   |
   | Книги 1         |     | Книги 2          |
   | Магазины A, B   |     | Магазины C, D    |
   +-----------------+     +------------------+
   ```

5. Режимы работы серверов:
   - В режиме чтения: все серверы могут принимать запросы на чтение данных от приложений. Запросы на чтение могут быть выполнены на любом из серверов баз данных.
   - В режиме записи: все запросы на запись данных должны быть отправлены на один из серверов баз данных, который будет ответственным за обновление данных. Этот сервер должен также обновить реплики данных на других серверах, чтобы обеспечить согласованность данных.

Такая система горизонтального и вертикального шаринга базы данных позволит распределить нагрузку и обеспечить более эффективную работу с данными.

